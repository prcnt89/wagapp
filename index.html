<!DOCTYPE html>
<html lang="de">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, viewport-fit=cover, orientation=landscape">
    <title>What a Goal!</title>
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" sizes="180x180" href="graphics/apple-touch-icon.png">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>


<audio id="goalSound" preload="auto">
    <source src="sounds/goal.mp3" type="audio/mpeg">
    Sounddateien werden von diesem Browser nicht unterstützt.
</audio>

<audio id="winSound" preload="auto">
    <source src="sounds/win.wav" type="audio/mpeg">
    Sounddateien werden von diesem Browser nicht unterstützt.
</audio>

<audio id="halftimeSound" preload="auto">
    <source src="sounds/haltime.mp3" type="audio/mpeg">
    Sounddateien werden von diesem Browser nicht unterstützt.
</audio>

<style>
@font-face {
    font-family: 'DINCond Medium';
    src: url('fonts/DINCond-Medium Regular.otf') format('opentype');
    font-weight: normal;
    font-style: normal;
}

@font-face {
    font-family: 'DINCond Black';
    src: url('fonts/DINCond-Black Regular.otf') format('opentype');
    font-weight: bold;
    font-style: normal;
}

strong {
    font-family: 'DINCond Black';
    }

#overlay {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 9998;
 }

#menu {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 10px; 
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 20px;
    width: 150px;
    max-width: 150px;
    display: none;
    z-index: 9999;
}

#menu.active {
    display: block;
}

#menu ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#menu ul li {
    cursor: pointer;
    padding: 10px 0;
    font-size: 18px;
    border-bottom: 1px solid #f0f0f0;
    transition: background-color 0.3s ease-in-out;
}

#menu ul li:hover {
    background-color: #f8f8f8;
}

#menu .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 24px;
    cursor: pointer;
    color: #888;
    transition: color 0.3s ease-in-out;
}

#menu .close:hover {
    color: #333;
}

#menu1 {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 10px; 
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 20px;
    width: 150px;
    max-width: 150px;
    display: none;
    z-index: 9999;
}

#menu1.active {
    display: block;
}

#menu1 ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#menu1 ul li {
    cursor: pointer;
    padding: 10px 0;
    font-size: 18px;
    border-bottom: 1px solid #f0f0f0;
    transition: background-color 0.3s ease-in-out;
}

#menu1 ul li:hover {
    background-color: #f8f8f8;
}

#menu1 .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 24px;
    cursor: pointer;
    color: #888;
    transition: color 0.3s ease-in-out;
}

#menu1 .close:hover {
    color: #333;
}

#menu2 {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: #fff;
    border: 1px solid #ccc;
    border-radius: 10px; 
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
    padding: 20px;
    width: 150px;
    max-width: 150px;
    display: none;
    z-index: 9999;
}

#menu2.active {
    display: block;
}

#menu2 ul {
    list-style: none;
    padding: 0;
    margin: 0;
}

#menu2 ul li {
    cursor: pointer;
    padding: 10px 0;
    font-size: 18px;
    border-bottom: 1px solid #f0f0f0;
    transition: background-color 0.3s ease-in-out;
}

#menu2 ul li:hover {
    background-color: #f8f8f8;
}

#menu2 .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 24px;
    cursor: pointer;
    color: #888;
    transition: color 0.3s ease-in-out;
}

#menu2 .close:hover {
    color: #333;
}

body {
    font-family: DINCond Medium;
    margin: 0;
    padding: 0;
    background-image: url("graphics/background.jpg");
    background-size: cover;
    background-repeat: no-repeat;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
}

.players-container {
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    overflow-x: hidden;
    gap: 15px;
}

.player-container {
    background-color: white;
    border-radius: 15px;
    padding: 20px;
    text-align: center;
    min-width: 300px;
    max-width: 300px;
    max-height: 298px;
    overflow-x: hidden;
    overflow-y: auto;
}

.player-name {
    font-size: 24px;
    margin-top: 10px;
    cursor: pointer;
}

.player-score {
    font-size: 90px;
    font-weight: bold;
    margin-bottom: -15px;
}

.icons {
    font-size: 30px;
    margin-top: 5px;
    margin-bottom: 15px;
}

.circle-icon {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: black;
    margin-right: -3px;
}

.circle-icon-menu {
    display: inline-flex;
    justify-content: center;
    align-items: center;
    width: 40px;
    height: 40px;
    border-radius: 50%;
    background-color: black;
    margin-right: -3px;
}

.fas.fa-bars {
    color: white;
}

.yellow-rectangle {
    display: inline-block;
    width: 12px;
    height: 17px;
    background-color: #f3e03b;
    transform: rotate(5deg);
}

.yellow-rectangle-list {
    display: inline-block;
    width: 11px;
    height: 16px;
    background-color: #f3e03b;
    transform: rotate(5deg);
    margin-right: 5px;
}

.red-rectangle {
    display: inline-block;
    width: 12px;
    height: 17px;
    background-color: red;
    transform: rotate(5deg);
}

.red-rectangle-list {
    display: inline-block;
    width: 11px;
    height: 16px;
    background-color: red;
    transform: rotate(5deg);
    margin-right: 5px;
}

.entry {
    text-align: left;
    margin-top: 5px;
}

.player-container:nth-child(1) .player-name {
    color: #ba3f1e;
}

.player-container:nth-child(2) .player-name {
    color: #0e477c;
}

.player-container:nth-child(1) {
    border: 4px solid #ba3f1e;
}

.player-container:nth-child(2) {
    border: 4px solid #0e477c;
}

.modern-button {
    display: flex;
    align-items: center;
}

.button-style {
    background-color: #007BFF;
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px 24px;
    font-size: 16px;
    cursor: pointer;
}

.player-container {
    margin-right: 20px;
}

.modal {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 20px;
    cursor: pointer;
}

#player1ModalName {
    font-family: DINCond Medium;
    color: #ba3f1e;
}

.player-name,
    #player1ModalName {
    font-family: DINCond Medium;
    color: #ba3f1e;
}

.square-container {
    text-align: center;
}

.square {
    display: inline-block;
    width: 30px;
    height: 30px;
    background-color: transparent;
    border: 1px solid black;
    border-radius: 2px;
    margin: 3px;
}

.extra-time-entry {
    display: flex;
    align-items: center;
    justify-content: center;
    margin-top: 5px;
    padding: 5px;
}

.extra-time-content {
    text-align: center;
    font-size: 14px;
    color: black;
}

.halftime-entry {
    display: flex;
    justify-content: center;
    align-items: center;
}

.finalscore-entry {
    display: flex;
    justify-content: center;
    align-items: center;
}

.score-animation {
    animation-name: scoreAnimation;
    animation-duration: 1s;
    animation-iteration-count: 7;
    animation-fill-mode: both;
}

@keyframes scoreAnimation {
    0%, 100% {
    transform: scale(1);
    }
    50% {
    transform: scale(1.5);
    }
}

.ht-modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: 1000;
    display: flex;
    justify-content: center;
    align-items: center;
}

.ht-modal-box {
    background-color: white;
    border-radius: 10px;
    padding: 20px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    max-width: 80%;
    text-align: left;
}

.ht-modal-box p {
    margin: 0;
    font-size: 14px;
    line-height: 1.5;
}

.winner-overlay {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-image: url('graphics/winner_background.jpg');
    background-size: cover;
    background-position: center;
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 9999;
    flex-direction: column;
    color: white;
    font-size: 34px;
    text-align: center;
}

.winner-overlay::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    z-index: -1;
}

.winner-content {
    position: relative;
    z-index: 1;
    text-align: center;
    color: white;
}

.winner-content img {
    max-width: 100%;
    height: auto;
}

.winner-content button {
    margin-top: 20px;
    background-color: #007bff;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    font-family: 'DINCond Medium';
}

.winner-content button:hover {
    background-color: #0056b3;
}

.winner-content .additional-text {
    font-size: 24px;
    animation: pulse 1.0s infinite;
    margin-top: -20px;
}

.winner-content .bold-text {
    font-weight: bold;
    animation: pulse 1.0s infinite;
    margin-top: -40px;
}

@keyframes pulse {
    0% { transform: scale(1); }
    50% { transform: scale(1.05); }
    100% { transform: scale(1); }
  }
  #animation p {
    font-size: 24px;
    margin-bottom: 20px;
  }
  #animation strong {
    font-weight: bold;
    font-size: 34px;
  }
  #animation p:last-child {
    margin-top: -1px;
  }

.xg-modal {
    display: none;
    position: fixed;
    z-index: 9999;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
}

.xg-modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
}

.xg-ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
}

.xg-add-shot-btn,
.xg-remove-shot-btn {
    background-color: black;
    color: white;
    border: none;
    border-radius: 8px;
    width: 30px;
    height: 30px;
    font-size: 16px;
    font-weight: bold;
    display: inline-flex;
    justify-content: center;
    align-items: center;
    margin-right: 10px;
    margin-bottom: 10px;
}

.hidden {
    display: none;
}

.xg-line-thin {
    border-top: 1px solid black;
    margin-top: 8px;
    margin-bottom: -15px;
}

.xg-line-thick {
    border-top: 4px solid black;
    margin-top: 5px;
}

#xgPlayer1Totalxg, #xgPlayer2Totalxg {
    font-size: 24px;
    font-weight: bold;
    text-align: center;
  }

.xg-label {
    font-size: 24px;
    font-weight: bold;
    text-align: center;
}

.player-xg {
    font-size: 16px;
    font-weight: bold;
    text-align: center;
}

.stats-modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.5);
    z-index: 1000;
}

.stats-modal-content {
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background-color: white;
    padding: 20px;
    border-radius: 10px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.3);
    max-width: 80%;
    text-align: left;
}

.stats-table {
    width: 100%;
    border-collapse: collapse;
}

.stats-table td {
    padding: 3px;
    text-align: center;
    line-height: 1.2;
}

.stats-table td:first-child,
.stats-table td:last-child {
    width: 45%;
}

.stats-modal .close {
    position: absolute;
    top: 10px;
    right: 10px;
    font-size: 30px;
    cursor: pointer;
}

/* Puls-Effekt Rot: Hintergrundfarbe 8% der Farbe #ba3f1e, langsamer */
.pulse-red {
    animation: pulseRed 3s infinite;
}
@keyframes pulseRed {
    0%   { background-color: #ffffff; }
    50%  { background-color: #ffe6e1; } /* 8% von #ba3f1e */
    100% { background-color: #ffffff; }
}

/* Puls-Effekt Blau: Hintergrundfarbe 8% der Farbe #0e477c, langsamer */
.pulse-blue {
    animation: pulseBlue 3s infinite;
}
@keyframes pulseBlue {
    0%   { background-color: #ffffff; }
    50%  { background-color: #e6f0fa; } /* 8% von #0e477c */
    100% { background-color: #ffffff; }
}
</style>
</head>

<body>
<div id="overlay"></div>
    <div class="players-container" id="playersContainer">

    <!-- Spieler 1 -->
    <div class="player-container" id="player1Container">
    <div class="player-name" contenteditable onclick="selectPlayerName(this)" onfocus="selectAllText(this)">Spieler 1</div>
    <div class="player-score" id="player1Score">0</div>
    <span class="player-xg">(</span><span id="player1XGValue" class="player-xg">0,00</span></strong><span class="player-xg"> xG)</span></p>
    <div class="icons">
    <span class="fas fa-futbol" style="color: black; margin-right: 5px;" onclick="increaseScore('player1Score')"></span>
    <span class="circle-icon" style="position: relative; top: 1px; margin-right: 5px;" onclick="addFoul('player1Score')">
    <span class="material-icons" style="color: white; position: relative; top: 1px;">sports</span>
    </span>
    <span class="circle-icon" style="position: relative; top: -3px; margin-right: 5px;" onclick="addYellowCard('player1Score')">
    <span class="yellow-rectangle" style="position: relative; top: 0px"></span>
    </span>
    <span class="circle-icon" style="position: relative; top: -3px; margin-right: 5px;" onclick="addRedCard('player1Score')">
    <span class="red-rectangle" style="position: relative; top: 0px"></span>
    </span>
    <span class="circle-icon" style="position: relative; top: -2px; margin-right: 5px;" onclick="addPenalty('player1Score')">
    <img src="graphics/elfmeter_white.svg" alt="" style="position: relative; top: 1px; width: 18px; height: 18px;">
    </span>
    <span class="circle-icon" style="position: relative; top: 1px; margin-right: 5px;" onclick="toggleMenu1()">
    <span class="material-icons" style="color: white; position: relative; top: 1px;">equalizer</span>
    </span>
    </div>
    <!-- Listeneinträge für Spieler 1 -->
    </div>

    <!-- Spieler 2 -->
    <div class="player-container" id="player2Container">
    <div class="player-name" contenteditable onclick="selectPlayerName(this)" onfocus="selectAllText(this)">Spieler 2</div>
    <div class="player-score" id="player2Score">0</div>
    <span class="player-xg">(</span><span id="player2XGValue" class="player-xg">0,00</span></strong><span class="player-xg"> xG)</span></p>
    <div class="icons">
    <span class="fas fa-futbol" style="color: black; margin-right: 5px;" onclick="increaseScore('player2Score')"></span>
    <span class="circle-icon" style="position: relative; top: 1px; margin-right: 5px;" onclick="addFoul('player2Score')">
    <span class="material-icons" style="color: white; position: relative; top: 1px;">sports</span>
    </span>
    <span class="circle-icon" style="position: relative; top: -3px; margin-right: 5px;" onclick="addYellowCard('player2Score')">
    <span class="yellow-rectangle" style="position: relative; top: 0px"></span>
    </span>
    <span class="circle-icon" style="position: relative; top: -3px; margin-right: 5px;" onclick="addRedCard('player2Score')">
    <span class="red-rectangle" style="position: relative; top: 0px"></span>
    </span>
    <span class="circle-icon" style="position: relative; top: -2px; margin-right: 5px;" onclick="addPenalty('player2Score')">
    <img src="graphics/elfmeter_white.svg" alt="" style="position: relative; top: 1px; width: 18px; height: 18px;">
    </span>
    <span class="circle-icon" style="position: relative; top: 1px; margin-right: 5px;" onclick="toggleMenu2()">
    <span class="material-icons" style="color: white; position: relative; top: 1px;">equalizer</span>
    </span>
    </div>
    <!-- Listeneinträge für Spieler 2 -->
    </div>
    </div>
</div>

<!-- Moderner Button für Elfmeterschießen -->
<div class="modern-button">
    <span class="fas fa-bars circle-icon-menu" style="cursor: pointer;" onclick="toggleMenu()"></span>
</div>

<!-- Menü -->
<div id="menu" class="active" style="display: none;">
    <ul>
    <span class="close" onclick="closeMenu()">&times;</span>
    <li onclick="openXGRechner(); closeMenu();">xG-Rechner</li>
    <li onclick="openStats(); closeMenu();">Statistiken</li>
    <li onclick="addExtraTime(); closeMenu();">Nachspielzeit</li>
    <li onclick="addHalftime(); closeMenu();">Halbzeit</li>
    <li style="margin-bottom: 15px;" onclick="addFinalScore(); closeMenu();">Spielende</li>
    <li onclick="startNewGame(); closeMenu();">Neues Spiel</li>
    </ul>
</div>

<!-- Menü Spieler 1 -->
<div id="menu1" class="active" style="display: none;">
    <ul>
    <span class="close" onclick="closeMenu1()">&times;</span>
    <li onclick="confirmBallPossession(1);closeMenu1();">Ballbesitz zum Spielzugende</li>
    <li onclick="passes(1);closeMenu1();">Pass</li>
    <li onclick="dribblings(1);closeMenu1();">Dribbling</li>
    <li onclick="tackles(1);closeMenu1();">Zweikampf</li>
    <li onclick="starPlayer(1);closeMenu1();">Starspieler ausgespielt</li>
    </ul>
</div>

<!-- Menü Spieler 2 -->
<div id="menu2" class="active" style="display: none;">
    <ul>
    <span class="close" onclick="closeMenu2()">&times;</span>
    <li onclick="confirmBallPossession(2);closeMenu2();">Ballbesitz zum Spielzugende</li>
    <li onclick="passes(2);closeMenu2();">Pass</li>
    <li onclick="dribblings(2);closeMenu2();">Dribbling</li>
    <li onclick="tackles(2);closeMenu2();">Zweikampf</li>
    <li onclick="starPlayer(2);closeMenu2();">Starspieler ausgespielt</li>
    </ul>
</div>

<!-- Modal für das Elfmeterschießen -->
<div id="myModal" class="modal">
    <div class="modal-content">
    <span class="close" onclick="closeModal()">&times;</span>
    <!-- Hier können die Inhalte des Modals platziert werden -->
    <h2>Elfmeterschießen</h2>
    <!-- Zeige den aktuellen Namen von Spieler 1 im Modal an -->
    <p>
    <span id="player1ModalName" class="player-name"></span>
    </p>
    <!-- Fünf Quadrate mit abgerundeten Ecken und dünnem schwarzen Rahmen für Spieler 1 -->
    <div class="square-container">
    <span class="square" onclick="showPenaltyResultModal(1)"></span>
    <span class="square" onclick="showPenaltyResultModal(1)"></span>
    <span class="square" onclick="showPenaltyResultModal(1)"></span>
    <span class="square" onclick="showPenaltyResultModal(1)"></span>
    <span class="square" onclick="showPenaltyResultModal(1)"></span>
    </div>
    <!-- Zeige den aktuellen Namen von Spieler 2 im Modal an -->
    <p>
    <span id="player2ModalName" class="player-name"></span>
    </p>
    <!-- Fünf Quadrate mit abgerundeten Ecken und dünnem schwarzen Rahmen für Spieler 2 -->
    <div class="square-container">
    <span class="square" onclick="showPenaltyResultModal(2)"></span>
    <span class="square" onclick="showPenaltyResultModal(2)"></span>
    <span class="square" onclick="showPenaltyResultModal(2)"></span>
    <span class="square" onclick="showPenaltyResultModal(2)"></span>
    <span class="square" onclick="showPenaltyResultModal(2)"></span>
    </div>
    </div>
</div>

<!-- Modal für den xG Rechner -->
<button id="xgOpenModal" class="hidden">xG Rechner öffnen</button>
<div id="xgRechnerModal" class="xg-modal">
    <div class="xg-modal-content">
        <span class="close" onclick="closeXGRechner()">&times;</span>
        <button id="xgCloseModal" class="hidden">Schließen</button>
        <h2>xG-Rechner</h2>
        <!-- Spieler 1 -->
        <div>
            <p>
                <span id="player1XGModalName" class="player-name"></span>
            </p>
            <button class="xg-add-shot-btn" data-player="1">+</button>
            <button class="xg-remove-shot-btn" data-player="1">-</button>
            <ul id="xgPlayer1Shots" class="xg-ul"></ul>
            <hr class="xg-line-thin" />
            <p style="text-align: center;"><strong><span id="xgPlayer1Totalxg">0,00</span></strong><span class="xg-label"> xG</span></p>
            <hr class="xg-line-thick" />
        </div>
        <!-- Spieler 2 -->
        <div>
            <p>
                <span id="player2XGModalName" class="player-name"></span>
            </p>
            <button class="xg-add-shot-btn" data-player="2">+</button>
            <button class="xg-remove-shot-btn" data-player="2">-</button>
            <ul id="xgPlayer2Shots" class="xg-ul"></ul>
            <hr class="xg-line-thin" />
            <p style="text-align: center;"><strong><span id="xgPlayer2Totalxg">0,00</span></strong><span class="xg-label"> xG</span></p>
        </div>
    </div>
</div>

<!-- Statistiken Modal -->
<div id="statsModal" class="stats-modal">
    <div class="stats-modal-content">
        <span class="close" onclick="closeStats()">&times;</span>
        <h2>Statistiken</h2>
        <table class="stats-table">
            <tr>
                <td id="player1StatsName" class="player-name"></td>
                <td></td>
                <td id="player2StatsName" class="player-name"></td>
            </tr>
            <tr>
                <td id="player1ScoreModal">0</td>
                <td>Tore</td>
                <td id="player2ScoreModal">0</td>
            </tr>
            <tr>
                <td id="player1XGModal">0</td>
                <td>xG</td>
                <td id="player2XGModal">0</td>
            </tr>
            <tr>
                <td id="lastShotPlayer1">0</td>
                <td>Torschüsse</td>
                <td id="lastShotPlayer2">0</td>
            </tr>
            <tr>
                <td id="passesPlayer1">0</td>
                <td>Pässe</td>
                <td id="passesPlayer2">0</td>
            </tr>
            <tr>
                <td id="successfulPassesPlayer1">0</td>
                <td>erfolgreiche Pässe</td>
                <td id="successfulPassesPlayer2">0</td>
            </tr>
            <tr>
                <td id="ballPossessionPlayer1">0</td>
                <td>Ballbesitz</td>
                <td id="ballPossessionPlayer2">0</td>
            </tr>
            <tr>
                <td id="dribblingsPlayer1">0</td>
                <td>Dribblings</td>
                <td id="dribblingsPlayer2">0</td>
            </tr>
            <tr>
                <td id="successfulDribblingsPlayer1">0</td>
                <td>erfolgreiche Dribblings</td>
                <td id="successfulDribblingsPlayer2">0</td>
            </tr>
            <tr>
                <td id="tacklesPlayer1">0</td>
                <td>Zweikämpfe</td>
                <td id="tacklesPlayer2">0</td>
            </tr>
            <tr>
                <td id="successfultacklesPlayer1">0</td>
                <td>erfolgreiche Zweikämpfe</td>
                <td id="successfultacklesPlayer2">0</td>
            </tr>
            <tr>
                <td id="foulsPlayer1">0</td>
                <td>Fouls</td>
                <td id="foulsPlayer2">0</td>
            </tr>
            <tr>
                <td id="yellowCardPlayer1">0</td>
                <td>Gelbe Karten</td>
                <td id="yellowCardPlayer2">0</td>
            </tr>
            <tr>
                <td id="redCardsPlayer1">0</td>
                <td>Rote Karten</td>
                <td id="redCardsPlayer2">0</td>
            </tr>
            <tr>
                <td id="penaltiesPlayer1">0</td>
                <td>Elfmeter</td>
                <td id="penaltiesPlayer2">0</td>
            </tr>
            <tr>
                <td id="starPlayer1">0</td>
                <td>Starspieler ausgespielt</td>
                <td id="starPlayer2">0</td>
            </tr>
            <tr>
                <td colspan="3" id="totalTurns"></td>
            </tr>
        </table>

        <!-- Export-Button unten zentriert -->
        <div style="text-align: center; margin-top: 20px;">
            <button id="exportButton" onclick="exportStatsAsImage()" style="
    margin-top: 20px;
    background-color: black;
    color: white;
    border: none;
    padding: 10px 20px;
    font-size: 16px;
    cursor: pointer;
    border-radius: 5px;
    font-family: 'DINCond Medium';
    display: block;
    margin-left: auto;
    margin-right: auto;
">Exportieren …</button>
        </div>
    </div>
</div>

<script>
let player1UnfilledSquares = 5;
let player1GreenSquares = 0;
let player2UnfilledSquares = 5;
let player2GreenSquares = 0;

// Funktion, um ein neues Spiel zu starten
function startNewGame() {
    var confirmed = confirm("Neues Spiel starten?");
    if (confirmed) {
    location.reload();
    }
}

// Funktion zum Ein- und Ausblenden des Menüs
function toggleMenu() {
    const menu = document.getElementById("menu");
    const overlay = document.getElementById("overlay");

    if (menu.style.display === "none") {
    menu.style.display = "block";
    overlay.style.display = "block";
    } else {
    menu.style.display = "none";
    overlay.style.display = "none";
    }
}

function toggleMenu1() {
    const menu1 = document.getElementById("menu1");
    const overlay = document.getElementById("overlay");

    if (menu1.style.display === "none") {
    menu1.style.display = "block";
    overlay.style.display = "block";
    } else {
    menu1.style.display = "none";
    overlay.style.display = "none";
    }
}

function toggleMenu2() {
    const menu2 = document.getElementById("menu2");
    const overlay = document.getElementById("overlay");

    if (menu2.style.display === "none") {
    menu2.style.display = "block";
    overlay.style.display = "block";
    } else {
    menu2.style.display = "none";
    overlay.style.display = "none";
    }
}

// Funktion zum Schließen des Menüs nach Auswahl eines Menüpunkts
function closeMenu() {
    const menu = document.getElementById("menu");
    const overlay = document.getElementById("overlay");
  
    menu.style.display = "none";
    overlay.style.display = "none";
}

function closeMenu1() {
    const menu1 = document.getElementById("menu1");
    const overlay = document.getElementById("overlay");
  
    menu1.style.display = "none";
    overlay.style.display = "none";
}

function closeMenu2() {
    const menu2 = document.getElementById("menu2");
    const overlay = document.getElementById("overlay");
  
    menu2.style.display = "none";
    overlay.style.display = "none";
}

// Funktion zum Öffnen des Menüs
    function openMenu() {
    const modal = document.getElementById("myModal");
    const player1ModalNameElement = document.getElementById("player1ModalName");
    player1ModalNameElement.textContent = player1Name;

    const player2ModalNameElement = document.getElementById("player2ModalName");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
    player2ModalNameElement.textContent = player2NameElement.textContent;
    player2ModalNameElement.style.color = getComputedStyle(player2NameElement).color;

    // Update the menu items
    const menuItems = document.getElementById("menuItems");
    menuItems.innerHTML = `
    <p><span class="fas fa-futbol" style="color: black; font-size: 16px;"></span> Elfmeterschießen</p>
    <p><span class="fas fa-cog" style="color: black; font-size: 16px;"></span> Einstellungen</p>
    `;

    modal.style.display = "block";
}

// Globale Variable, um den aktuellen Namen von Spieler 1 zu speichern
let player1Name = "Spieler 1"; // Standardname

// Eine Funktion erstellen, um einen leeren Eintrag für den anderen Spieler hinzuzufügen
function addEmptyEntry(playerId) {
    const playerScoreElement = document.getElementById(playerId);
    const playerName = playerId === "player1Score" ? "Spieler 2" : "Spieler 1";

    const entryElement = document.createElement("div");
    entryElement.classList.add("entry");
    entryElement.innerHTML = `&nbsp;`;

    playerScoreElement.parentElement.appendChild(entryElement);
}

// Funktion, um die Torzahl eines Spielers zu erhöhen
function increaseScore(playerId) {
    const playerScoreElement = document.getElementById(playerId);
    let score = parseInt(playerScoreElement.textContent);

    // Eingabeaufforderung für Spielminute und Torschützen
    const minuteInput = prompt("Spielminute eingeben (2-stellige Zahl):");
    if (minuteInput && /^\d{2}$/.test(minuteInput)) {
    const scorerName = prompt("Torschützen eingeben (leer = 'Standardspieler'):");
    const playerName = scorerName || "Standardspieler";

    // Erstellen der neuen Einträge mit Ball-Symbol und Informationen
    const entryElement = document.createElement("div");
    entryElement.classList.add("entry");
    entryElement.innerHTML = `<span class="fas fa-futbol" style="color: black; font-size: 16px;"></span> ${minuteInput}' ${playerName}`;
    playerScoreElement.parentElement.appendChild(entryElement);

    // Torzahl des Spielers um 1 erhöhen
    playerScoreElement.textContent = score + 1;

    // Torsound abspielen
    playGoalSound();

    // Punkt-Animation hinzufügen
    playerScoreElement.classList.add("score-animation");

    // Nach 8 Sekunden die Punkt-Animation entfernen
    setTimeout(() => {
    playerScoreElement.classList.remove("score-animation");
    }, 8000);

    // Einen leeren Eintrag für den anderen Spieler hinzufügen
    const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
    addEmptyEntry(otherPlayerId);
    } else {
    alert("Ungültige Eingabe. Tor wird nicht gezählt.");
    }
}

// Funktion, um einen Listeneintrag zu löschen
function removeLastEntryAndDeductPoint(playerId) {
    const playerScoreElement = document.getElementById(playerId);
    const entryElements = playerScoreElement.parentElement.getElementsByClassName("entry");

    if (entryElements.length > 0) {
        const lastEntry = entryElements[entryElements.length - 1];
        const futbolIcon = lastEntry.querySelector(".fas.fa-futbol");
        const elfmeterIcon = lastEntry.querySelector("img[src='graphics/elfmeter_black.svg']");

        if (futbolIcon || elfmeterIcon) {
            // Remove 1 point if the futbol or elfmeter icon is present
            let score = parseInt(playerScoreElement.textContent);
            if (score > 0) {
                playerScoreElement.textContent = score - 1;
            }
        }

        // Prüfe, ob der andere Spieler an gleicher Position einen nicht-leeren Eintrag hat
        const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
        const otherPlayerScoreElement = document.getElementById(otherPlayerId);
        const otherEntryElements = otherPlayerScoreElement.parentElement.getElementsByClassName("entry");

        if (otherEntryElements.length > 0) {
            const lastOtherEntry = otherEntryElements[otherEntryElements.length - 1];
            if (lastOtherEntry.textContent.trim() !== "") {
                // Eintrag mit Text vorhanden, zeige einen Fehler an
                alert("Dieser Eintrag kann nicht gelöscht werden.");
                return; // Beende die Funktion ohne weiteren Aktionen
            }
        }

        // Den letzten Eintrag entfernen
        lastEntry.remove();

        // Entferne die leere Zeile des anderen Spielers
        if (otherEntryElements.length > 0) {
            const lastOtherEntry = otherEntryElements[otherEntryElements.length - 1];
            if (lastOtherEntry.textContent.trim() === "") {
                lastOtherEntry.remove();
            }
        }
    }
}

let foulsPlayer1 = 0;  // Variable für Fouls von Spieler 1
let foulsPlayer2 = 0;  // Variable für Fouls von Spieler 2

// Funktion, um ein Foul für einen Spieler hinzuzufügen
function addFoul(playerId) {
    const playerScoreElement = document.getElementById(playerId);

    // Eingabeaufforderung für Spielminute
    const minuteInput = prompt("Spielminute eingeben (2-stellige Zahl):");
    if (minuteInput && /^\d{2}$/.test(minuteInput)) {
        // Erstellen der neuen Einträge mit Foul und Informationen
        const entryElement = document.createElement("div");
        entryElement.classList.add("entry");
        entryElement.innerHTML = `<span class="material-icons" style="color: black; font-size: 21px; position: relative; top: 5px; left: -2px; margin-right: -5px; margin-top: -6px;">sports</span> ${minuteInput}' Foul`;
        playerScoreElement.parentElement.appendChild(entryElement);

        // Einen leeren Eintrag für den anderen Spieler hinzufügen
        const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
        addEmptyEntry(otherPlayerId);

        // Foul zählen und im Modal aktualisieren
        if (playerId === "player1Score") {
            foulsPlayer1++;  // Foul für Spieler 1
        } else {
            foulsPlayer2++;  // Foul für Spieler 2
        }

        // Foulzähler im Modal aktualisieren
        document.getElementById('foulsPlayer1').textContent = foulsPlayer1;
        document.getElementById('foulsPlayer2').textContent = foulsPlayer2;

    } else {
        alert("Ungültige Eingabe. Das Foul wird nicht hinzugefügt.");
    }
}

// Zählvariablen für gelbe Karten pro Spieler
let yellowCardCountPlayer1 = 0;
let yellowCardCountPlayer2 = 0;

// Funktion, um eine gelbe Karte für einen Spieler hinzuzufügen
function addYellowCard(playerId) {
    const playerScoreElement = document.getElementById(playerId);

    // Eingabeaufforderung für Spielminute
    const minuteInput = prompt("Spielminute eingeben (2-stellige Zahl):");
    if (minuteInput && /^\d{2}$/.test(minuteInput)) {
        // Erstellen der neuen Einträge mit gelber Karte und Informationen
        const entryElement = document.createElement("div");
        entryElement.classList.add("entry");
        entryElement.innerHTML = `<span class="yellow-rectangle-list" style="position: relative; top: 1px; left: 2px; margin-top: -2px;"></span> ${minuteInput}' Gelbe Karte`;
        playerScoreElement.parentElement.appendChild(entryElement);

        // Erhöhen der gelben Karten-Zählung für den jeweiligen Spieler
        if (playerId === "player1Score") {
            yellowCardCountPlayer1++;
        } else if (playerId === "player2Score") {
            yellowCardCountPlayer2++;
        }

        // Einen leeren Eintrag für den anderen Spieler hinzufügen
        const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
        addEmptyEntry(otherPlayerId);
        
        // Optional: Ausgabe der aktuellen Anzahl der gelben Karten für den Spieler
        console.log(`${playerId} hat jetzt ${playerId === "player1Score" ? yellowCardCountPlayer1 : yellowCardCountPlayer2} gelbe Karte(n).`);
    } else {
        alert("Ungültige Eingabe. Die gelbe Karte wird nicht hinzugefügt.");
    }
}

// Eine Funktion erstellen, um einen leeren Eintrag für den anderen Spieler hinzuzufügen
function addEmptyEntry(playerId) {
    const playerScoreElement = document.getElementById(playerId);
    const playerName = playerId === "player1Score" ? "Spieler 2" : "Spieler 1";

    const entryElement = document.createElement("div");
    entryElement.classList.add("entry");
    entryElement.innerHTML = `&nbsp;`;

    playerScoreElement.parentElement.appendChild(entryElement);
}

// Zählvariablen für rote Karten pro Spieler
let redCardsPlayer1 = 0;
let redCardsPlayer2 = 0;

// Funktion, um eine rote Karte für einen Spieler hinzuzufügen
function addRedCard(playerId) {
    const playerScoreElement = document.getElementById(playerId);

    // Eingabeaufforderung für Spielminute und Spielername
    const minuteInput = prompt("Spielminute eingeben (2-stellige Zahl):");
    if (minuteInput && /^\d{2}$/.test(minuteInput)) {
        const scorerName = prompt("Spielernamen eingeben (leer = 'Standardspieler'):");
        const playerName = scorerName || "Standardspieler";

        // Erstellen der neuen Einträge mit roter Karte und Informationen
        const entryElement = document.createElement("div");
        entryElement.classList.add("entry");
        entryElement.innerHTML = `<span class="red-rectangle-list" style="position: relative; top: 1px; left: 2px; margin-top: -2px;"></span> ${minuteInput}' ${playerName}`;
        playerScoreElement.parentElement.appendChild(entryElement);

        // Einen leeren Eintrag für den anderen Spieler hinzufügen
        const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
        addEmptyEntry(otherPlayerId);

        // Rote Karte zählen und im Modal aktualisieren
        if (playerId === "player1Score") {
            redCardsPlayer1++;  // Rote Karte für Spieler 1
        } else {
            redCardsPlayer2++;  // Rote Karte für Spieler 2
        }

        // Rote Karten im Modal aktualisieren
        document.getElementById('redCardsPlayer1').textContent = redCardsPlayer1;
        document.getElementById('redCardsPlayer2').textContent = redCardsPlayer2;

    } else {
        alert("Ungültige Eingabe. Die rote Karte wird nicht hinzugefügt.");
    }
}

// Variablen zur Speicherung der Elfmeter-Statistiken
let penaltiesPlayer1 = 0;
let penaltiesPlayer2 = 0;
let penaltiesScoredPlayer1 = 0;
let penaltiesScoredPlayer2 = 0;
let penaltiesMissedPlayer1 = 0;
let penaltiesMissedPlayer2 = 0;

function addPenalty(playerId) {
    const playerScoreElement = document.getElementById(playerId);

    // Abfrage, ob der Elfmeter verwandelt wurde
    const penaltyConverted = window.confirm("Elfmeter verwandelt?");
    
    // Eingabe der Spielminute
    const minuteInput = prompt("Spielminute eingeben (2-stellige Zahl):");
    if (!(minuteInput && /^\d{2}$/.test(minuteInput))) {
        alert("Ungültige Eingabe. Tor wird nicht gezählt.");
        return;
    }

    // Festlegen des Icons für verwandelten oder verschossenen Elfmeter
    const iconSrc = penaltyConverted ? "graphics/elfmeter_black.svg" : "graphics/elfmeter_missed.svg";
    
    // Erstellen des Eintrags für den Elfmeter
    const entryElement = document.createElement("div");
    entryElement.classList.add("entry");
    entryElement.innerHTML = `<img src="${iconSrc}" alt="" style="width: 16px; height: 16px; position: relative; top: 3px;"> ${minuteInput}' Elfmeter`;
    playerScoreElement.parentElement.appendChild(entryElement);

    // Statistiken aktualisieren
    if (playerId === "player1Score") {
        penaltiesPlayer1++;
        if (penaltyConverted) {
            penaltiesScoredPlayer1++;
        } else {
            penaltiesMissedPlayer1++;
        }
    } else {
        penaltiesPlayer2++;
        if (penaltyConverted) {
            penaltiesScoredPlayer2++;
        } else {
            penaltiesMissedPlayer2++;
        }
    }

    console.log(`Spieler 1: ${penaltiesPlayer1} Elfmeter (${penaltiesScoredPlayer1} getroffen, ${penaltiesMissedPlayer1} verschossen)`);
    console.log(`Spieler 2: ${penaltiesPlayer2} Elfmeter (${penaltiesScoredPlayer2} getroffen, ${penaltiesMissedPlayer2} verschossen)`);

    // Falls der Elfmeter verwandelt wurde, Torzahl aktualisieren und Animation/Sound ausführen
    if (penaltyConverted) {
        let score = parseInt(playerScoreElement.textContent);
        playerScoreElement.textContent = score + 1;
        playGoalSound();
        playerScoreElement.classList.add("score-animation");
        setTimeout(() => playerScoreElement.classList.remove("score-animation"), 8000);
    }

    // Leeren Eintrag für den anderen Spieler hinzufügen
    const otherPlayerId = playerId === "player1Score" ? "player2Score" : "player1Score";
    addEmptyEntry(otherPlayerId);

    // Statistiken im Modal aktualisieren
    updatePenaltyStats();
}

// Funktion zur Aktualisierung der Elfmeter-Statistiken im Modal
function updatePenaltyStats() {
    document.getElementById('penaltiesPlayer1').textContent = `${penaltiesPlayer1} (${penaltiesScoredPlayer1} getroffen, ${penaltiesMissedPlayer1} verschossen)`;
    document.getElementById('penaltiesPlayer2').textContent = `${penaltiesPlayer2} (${penaltiesScoredPlayer2} getroffen, ${penaltiesMissedPlayer2} verschossen)`;
}

// Event Listener hinzufügen, um die Zeichenanzahl bei der Eingabe zu überwachen
    const playerNameElements = document.querySelectorAll(".player-name[contenteditable]");
    playerNameElements.forEach((element) => {
    element.addEventListener("blur", handlePlayerNameInput);
    });

// Funktion, die aufgerufen wird, wenn sich die Eingabe eines Spielernamens ändert (Spieler 1)
    const playerNameElementPlayer1 = document.querySelector(".player-container:nth-child(1) .player-name[contenteditable]");
    playerNameElementPlayer1.addEventListener("blur", handlePlayerNameInput);

// Funktion, die aufgerufen wird, wenn sich die Eingabe eines Spielernamens ändert (Spieler 2)
    const playerNameElementPlayer2 = document.querySelector(".player-container:nth-child(2) .player-name[contenteditable]");
    playerNameElementPlayer2.addEventListener("blur", handlePlayerNameInput);

// Gemeinsame Funktion, die aufgerufen wird, wenn sich die Eingabe eines Spielernamens ändert
function handlePlayerNameInput(event) {
    const playerNameElement = event.target;
    let playerName = playerNameElement.textContent.trim();
    const maxNameLength = 20;

    // Setze den Standardnamen (Spieler 1 oder Spieler 2) falls kein Name eingegeben wurde oder leer ist
    if (playerName === "" || playerName === "Spieler 1" || playerName === "Spieler 2") {
    playerName = "Spieler " + (playerNameElement === playerNameElementPlayer1 ? "1" : "2");
    playerNameElement.textContent = playerName;
    } else if (playerName.length > maxNameLength) {
    // Begrenze den Spielernamen auf die maximale Länge
    playerNameElement.textContent = playerName.slice(0, maxNameLength);
}

// Positioniere den Cursor am Ende des Textes, um zu verhindern, dass Zeichen am Anfang hinzugefügt werden
    const range = document.createRange();
    const selection = window.getSelection();
    range.selectNodeContents(playerNameElement);
    range.collapse(false);
    selection.removeAllRanges();
    selection.addRange(range);

// Fokus vom "contenteditable"-Element entfernen, wenn der Benutzer außerhalb davon klickt
    playerNameElement.blur();

// Speichere den aktuellen Namen von Spieler 1 in der globalen Variable
    if (playerNameElement === playerNameElementPlayer1) {
    player1Name = playerName;
    }
    }

// Funktion, um den Spielername auszuwählen, wenn darauf geklickt wird
function selectPlayerName(element) {
    const range = document.createRange();
    range.selectNodeContents(element);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);
}

// Inhalt des Eingabefelds markieren, wenn es den Fokus erhält.
function selectAllText(element) {
    const range = document.createRange();
    range.selectNodeContents(element);
    const selection = window.getSelection();
    selection.removeAllRanges();
    selection.addRange(range);
}

// Funktion, um das Modal zu öffnen
function openModal() {
    const modal = document.getElementById("myModal");
    const player1ModalNameElement = document.getElementById("player1ModalName");
    player1ModalNameElement.textContent = player1Name;

    const player2ModalNameElement = document.getElementById("player2ModalName");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
    player2ModalNameElement.textContent = player2NameElement.textContent;
    player2ModalNameElement.style.color = getComputedStyle(player2NameElement).color;

    modal.style.display = "block";
}

// Funktion, um das Modal zu schließen
function closeModal() {
    const modal = document.getElementById("myModal");
    modal.style.display = "none";
}

// Funktion, die aufgerufen wird, wenn der "Elfmeterschießen"-Button geklickt wird
function startElfmeterschiessen() {
    openModal();
}

// Funktion, um das suddenDeath-Elfmeterschießen zu verarbeiten
function suddenDeath() {
    // Hole die Namen der Spieler
    const player1NameElement = document.querySelector(".player-container:nth-child(1) .player-name");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
    const player1Name = player1NameElement.textContent.trim();
    const player2Name = player2NameElement.textContent.trim();

    while (true) {
    // Fordere den Benutzer auf, zu wählen, welcher Spieler das suddenDeath-Elfmeterschießen beginnt
    const startingPlayer = prompt(`Welcher Spieler soll beginnen?\n'1' = ${player1Name}\n'2' = ${player2Name}`);
    if (startingPlayer === "1" || startingPlayer === "2") {
    // Konvertiere die Eingabe in eine Zahl
    const startingPlayerNumber = parseInt(startingPlayer);

    // Setze die Punktzahlen und verfügbaren Elfmeter für das suddenDeath zurück
    player1GreenSquares = 0;
    player2GreenSquares = 0;
    player1UnfilledSquares = 5;
    player2UnfilledSquares = 5;

    // Bestimmen, welcher Spieler beginnt
    let firstPenaltyPlayerNumber, secondPenaltyPlayerNumber;
    if (startingPlayerNumber === 1) {
    firstPenaltyPlayerNumber = 1;
    secondPenaltyPlayerNumber = 2;
    } else {
    firstPenaltyPlayerNumber = 2;
    secondPenaltyPlayerNumber = 1;
    }

    // SuddenDeath-Elfmeterschießen
    while (true) {
    const firstPenaltyResult = window.confirm(`Hat ${firstPenaltyPlayerNumber === 1 ? player1Name : player2Name} den Elfmeter verwandelt?`);
    const secondPenaltyResult = window.confirm(`Hat ${secondPenaltyPlayerNumber === 1 ? player1Name : player2Name} den Elfmeter verwandelt?`);

    if (firstPenaltyResult) {
    if (firstPenaltyPlayerNumber === 1) {
    player1GreenSquares++;
    const player1ScoreElement = document.getElementById("player1Score");
    let player1Score = parseInt(player1ScoreElement.textContent);
    player1ScoreElement.textContent = player1Score + 1; // Punkt für Spieler 1 hinzufügen
    } else {
    player2GreenSquares++;
    const player2ScoreElement = document.getElementById("player2Score");
    let player2Score = parseInt(player2ScoreElement.textContent);
    player2ScoreElement.textContent = player2Score + 1; // Punkt für Spieler 2 hinzufügen
    }
    } else {
    if (firstPenaltyPlayerNumber === 1) {
    player1UnfilledSquares--;
    } else {
    player2UnfilledSquares--;
    }
    }

    if (secondPenaltyResult) {
    if (secondPenaltyPlayerNumber === 1) {
    player1GreenSquares++;
    const player1ScoreElement = document.getElementById("player1Score");
    let player1Score = parseInt(player1ScoreElement.textContent);
    player1ScoreElement.textContent = player1Score + 1; // Punkt für Spieler 1 hinzufügen
    } else {
    player2GreenSquares++;
    const player2ScoreElement = document.getElementById("player2Score");
    let player2Score = parseInt(player2ScoreElement.textContent);
    player2ScoreElement.textContent = player2Score + 1; // Punkt für Spieler 2 hinzufügen
    }
    } else {
    if (secondPenaltyPlayerNumber === 1) {
    player1UnfilledSquares--;
    } else {
    player2UnfilledSquares--;
    }
    }

    if (player1GreenSquares !== player2GreenSquares || player1UnfilledSquares === 0 || player2UnfilledSquares === 0) {
    break; // Wenn ein Spieler mehr Tore erzielt hat oder keine Elfmeter mehr übrig sind, endet das suddenDeath.
    }
    }

    // Überprüfe, wer das suddenDeath gewonnen hat oder ob es unentschieden ist
    if (player1GreenSquares > player2GreenSquares) {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    } else if (player2GreenSquares > player1GreenSquares) {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    } else {
    // Bei Gleichstand müssen wir eine zusätzliche Entscheidungsrunde hinzufügen
    while (true) {
    const firstPenaltyResult = window.confirm(`${player1Name}, Elfmeter verwandelt?`);
    const secondPenaltyResult = window.confirm(`${player2Name}, Elfmeter verwandelt?`);

    if (firstPenaltyResult !== secondPenaltyResult) {
    // Der Spieler, der seinen Elfmeter verwandelt hat, gewinnt das suddenDeath
    if (firstPenaltyResult) {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    } else {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    }
    break;
    }
    // Ansonsten geht das suddenDeath mit einer neuen Entscheidungsrunde weiter
    }
    }

    break; // Beende die äußere Schleife, da das Elfmeterschießen abgeschlossen ist
    } else {
    alert("Ungültige Eingabe. Bitte '1' oder '2' eingeben.");
    }
    }
}


// Funktion, um das Elfmeterergebnis anzuzeigen und zu überprüfen, ob ein Spieler gewonnen hat
function showPenaltyResultModal(playerNumber) {
    const penaltyResult = window.confirm("Elfmeter verwandelt?");
    const square = event.target; // Das geklickte Quadrat

    if (penaltyResult) {
    // Der Benutzer hat "Ja" gewählt (Elfmeter verwandelt)
    square.style.backgroundColor = "green"; // Das Quadrat wird grün gefärbt
    const playerScoreElement = document.getElementById(`player${playerNumber}Score`);
    let score = parseInt(playerScoreElement.textContent);
    playerScoreElement.textContent = score + 1; // Punktestand des Spielers wird um 1 erhöht

    // Torsound abspielen
    playGoalSound();

    // Punkt-Animation hinzufügen
    playerScoreElement.classList.add("score-animation");

    // Nach 8 Sekunden die Punkt-Animation entfernen
    setTimeout(() => {
    playerScoreElement.classList.remove("score-animation");
    }, 8000);

    // Zähle die grünen Quadrate und verringere die Anzahl der ungefärbten Quadrate
    if (playerNumber === 1) {
    player1GreenSquares++;
    player1UnfilledSquares--;
    } else if (playerNumber === 2) {
    player2GreenSquares++;
    player2UnfilledSquares--;
    }
    } else {
    // Der Benutzer hat "Nein" gewählt (Elfmeter nicht verwandelt)
    square.style.backgroundColor = "red"; // Das Quadrat wird rot gefärbt
    if (playerNumber === 1) {
    player1UnfilledSquares--;
    } else if (playerNumber === 2) {
    player2UnfilledSquares--;
    }
    }

    square.onclick = null; // Das 'onclick' Ereignis wird entfernt, um das Quadrat zu deaktivieren

    // Überprüfe, ob ein Spieler mehr grüne Quadrate hat als der andere Spieler erreichen kann
    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");
    let player1Score = parseInt(player1ScoreElement.textContent);
    let player2Score = parseInt(player2ScoreElement.textContent);
    let player1MaxPossibleScore = player1GreenSquares + player1UnfilledSquares;
    let player2MaxPossibleScore = player2GreenSquares + player2UnfilledSquares;

    // Den Namen von Spieler 1 und Spieler 2 direkt aus den DOM-Elementen abrufen
    const player1NameElement = document.querySelector(".player-container:nth-child(1) .player-name");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
    const player1Name = player1NameElement.textContent.trim();
    const player2Name = player2NameElement.textContent.trim();

    // Überprüfe, ob ein Spieler gewonnen hat und zeige entsprechende Meldung an
    if (player1GreenSquares > player2MaxPossibleScore && player2GreenSquares <= player1MaxPossibleScore) {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    } else if (player2GreenSquares > player1MaxPossibleScore && player1GreenSquares <= player2MaxPossibleScore) {
    addFinalScoreAndPenalty();
    checkWinnerAndShowScreen();
    } else if (player1GreenSquares === player2GreenSquares && player1UnfilledSquares === 0 && player2UnfilledSquares === 0) {
    // Wenn beide Spieler nach den ersten fünf Elfmetern immer noch unentschieden sind und keine ungenutzten Elfmeter mehr haben, starte den suddenDeath.
    alert("Unentschieden! Es geht weiter ...");
    suddenDeath();
    }
}

// Funktion, um die Nachspielzeit hinzuzufügen
function addExtraTime() {
    const extraTimeInput = prompt("Wie viel Nachspielzeit gibt es? (Zahl von 1 bis 15):");

    const isValidInput = /^\d{1,2}$/.test(extraTimeInput);
    const extraTimeValue = parseInt(extraTimeInput);

    if (isValidInput && extraTimeValue >= 1 && extraTimeValue <= 15) {
        const extraTimeElement = document.createElement("div");
        extraTimeElement.classList.add("entry");
        extraTimeElement.classList.add("extra-time-entry");

        const extraTimeContent = document.createElement("span");
        extraTimeContent.classList.add("extra-time-content");
        extraTimeContent.textContent = `Nachspielzeit ${extraTimeValue}'`;

        extraTimeElement.appendChild(extraTimeContent);

        const player1ScoreElement = document.getElementById("player1Score");
        const player2ScoreElement = document.getElementById("player2Score");

        const player1EventsContainer = player1ScoreElement.parentElement;
        const player2EventsContainer = player2ScoreElement.parentElement;

        player1EventsContainer.appendChild(extraTimeElement.cloneNode(true));
        player2EventsContainer.appendChild(extraTimeElement);
    } else {
        alert("Ungültige Eingabe. Die Nachspielzeit wird nicht hinzugefügt.");
    }
}

// Funktion, um zu überprüfen, ob der Halbzeiteintrag bereits vorhanden ist
function isHalftimeEntryPresent() {
    const halftimeEntries = document.querySelectorAll(".halftime-entry");
    return halftimeEntries.length > 0;
}

// Funktion, um die Halbzeit anzuzeigen
function addHalftime() {
    if (isHalftimeEntryPresent()) {
        alert("Die 1. Halbzeit wurde bereits abgeschlossen!"); // Fehlermeldung, falls vorhanden
        return;
    }
    const halftimeElement = document.createElement("div");
    halftimeElement.classList.add("entry");
    halftimeElement.classList.add("halftime-entry");

    // Stil für die graue Hintergrundfläche mit abgerundeten Ecken und Anpassungen
    halftimeElement.style.backgroundColor = "rgba(0, 0, 0, 0.08)";
    halftimeElement.style.borderRadius = "10px";
    halftimeElement.style.padding = "3px 0";
    halftimeElement.style.margin = "10px 0";

    const halftimeContent = document.createElement("span");
    halftimeContent.classList.add("halftime-content");
    halftimeContent.textContent = "Halbzeit";

    // Halbzeit-Sound abspielen
    playHalftimeSound();

    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");

    const player1EventsContainer = player1ScoreElement.parentElement;
    const player2EventsContainer = player2ScoreElement.parentElement;

    const scoreSpacer = document.createElement("span");
    scoreSpacer.classList.add("score-spacer");
    scoreSpacer.textContent = "\u00A0"; // Unicode-Zeichen für ein schmales Leerzeichen

    halftimeElement.appendChild(halftimeContent);
    halftimeElement.appendChild(scoreSpacer.cloneNode(true));
    halftimeElement.appendChild(document.createTextNode(player1ScoreElement.textContent));
    halftimeElement.appendChild(document.createTextNode("-"));
    halftimeElement.appendChild(document.createTextNode(player2ScoreElement.textContent));

    player1EventsContainer.appendChild(halftimeElement.cloneNode(true));
    player2EventsContainer.appendChild(halftimeElement);

    // Erstellung der Modalbox
    const modalOverlay = document.createElement("div");
    modalOverlay.classList.add("ht-modal-overlay");

    const modalBox = document.createElement("div");
    modalBox.classList.add("ht-modal-box");

    const modalTitle = document.createElement("h2");
    modalTitle.textContent = "Vorbereitung auf die 2. Halbzeit:";

    const modalText = document.createElement("p");
    modalText.innerHTML = `
        1. Eine Halbzeitansprachenkarte aufdecken und ab Beginn der 2. Halbzeit beachten.<br>
        2. Den 2. Spielzeitmarker auf das Pfeifensymbol legen.<br>
        3. Den Ball auf den Anstoßkreis legen und auf die Farbe des Spielzeitmarkers drehen.<br>
        4. Alle Transfermarktkarten in das Reservedeck mischen und 6 neue Karten aufdecken.<br>
        5. Alle Hand- und Ablagestapel in den Mannschaftsstapel mischen und 6 neue Karten ziehen.<br>
        6. Sofern erwünscht, die Aufstellungsmarker neu anordnen (entsprechend der Aufstellungs- und Starspielerkarten).<br>
        7. Ersten Spielzug der 2. Halbzeit beginnen.
    `;

    const closeButton = document.createElement("button");
    closeButton.textContent = "Erledigt";
    closeButton.classList.add("modal-close-button");

    // Stil für den "Erledigt"-Button
    closeButton.style.marginTop = "20px";
    closeButton.style.backgroundColor = "black";
    closeButton.style.color = "white";
    closeButton.style.border = "none";
    closeButton.style.padding = "10px 20px";
    closeButton.style.fontSize = "16px";
    closeButton.style.cursor = "pointer";
    closeButton.style.borderRadius = "5px";
    closeButton.style.fontFamily = "DINCond Medium";

    // Hover-Stil für den Button
    closeButton.addEventListener("mouseover", () => {
    closeButton.style.backgroundColor = "black";
    });

    closeButton.addEventListener("mouseout", () => {
    closeButton.style.backgroundColor = "black";
    });

    // Event Listener für den Button hinzufügen
    closeButton.addEventListener("click", () => {
    document.body.removeChild(modalOverlay);
    });

    modalBox.appendChild(modalTitle);
    modalBox.appendChild(modalText);
    modalBox.appendChild(closeButton);
    modalOverlay.appendChild(modalBox);
    document.body.appendChild(modalOverlay);
}

// Funktion, um den Endstand anzuzeigen
function addFinalScore() {
    const finalscoreElement = document.createElement("div");
    finalscoreElement.classList.add("entry");
    finalscoreElement.classList.add("finalscore-entry");

    // Stil für die graue Hintergrundfläche mit abgerundeten Ecken und Anpassungen
    finalscoreElement.style.backgroundColor = "rgba(0, 0, 0, 0.08)";
    finalscoreElement.style.borderRadius = "10px";
    finalscoreElement.style.padding = "3px 0";
    finalscoreElement.style.margin = "10px 0";

    const finalscoreContent = document.createElement("span");
    finalscoreContent.classList.add("finalscore-content");
    finalscoreContent.textContent = "Endstand";

    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");

    const player1EventsContainer = player1ScoreElement.parentElement;
    const player2EventsContainer = player2ScoreElement.parentElement;

    const scoreSpacer = document.createElement("span");
    scoreSpacer.classList.add("score-spacer");
    scoreSpacer.textContent = "\u00A0"; // Unicode-Zeichen für ein schmales Leerzeichen

    finalscoreElement.appendChild(finalscoreContent);
    finalscoreElement.appendChild(scoreSpacer.cloneNode(true));
    finalscoreElement.appendChild(document.createTextNode(player1ScoreElement.textContent));
    finalscoreElement.appendChild(document.createTextNode("-"));
    finalscoreElement.appendChild(document.createTextNode(player2ScoreElement.textContent));

    player1EventsContainer.appendChild(finalscoreElement.cloneNode(true));
    player2EventsContainer.appendChild(finalscoreElement);
    checkWinnerAndShowScreen();
}

// Funktion, um den Endstand + Elfmeter anzuzeigen
function addFinalScoreAndPenalty() {
    const finalscoreElement = document.createElement("div");
    finalscoreElement.classList.add("entry");
    finalscoreElement.classList.add("finalscore-entry");

    // Stil für die graue Hintergrundfläche mit abgerundeten Ecken und Anpassungen
    finalscoreElement.style.backgroundColor = "rgba(0, 0, 0, 0.08)";
    finalscoreElement.style.borderRadius = "10px";
    finalscoreElement.style.padding = "3px 0";
    finalscoreElement.style.margin = "10px 0";

    const finalscoreContent = document.createElement("span");
    finalscoreContent.classList.add("finalscore-content");
    finalscoreContent.textContent = "Endstand + Elfmeter";

    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");

    const player1EventsContainer = player1ScoreElement.parentElement;
    const player2EventsContainer = player2ScoreElement.parentElement;

    const scoreSpacer = document.createElement("span");
    scoreSpacer.classList.add("score-spacer");
    scoreSpacer.textContent = "\u00A0"; // Unicode-Zeichen für ein schmales Leerzeichen

    finalscoreElement.appendChild(finalscoreContent);
    finalscoreElement.appendChild(scoreSpacer.cloneNode(true));
    finalscoreElement.appendChild(document.createTextNode(player1ScoreElement.textContent));
    finalscoreElement.appendChild(document.createTextNode("-"));
    finalscoreElement.appendChild(document.createTextNode(player2ScoreElement.textContent));

    player1EventsContainer.appendChild(finalscoreElement.cloneNode(true));
    player2EventsContainer.appendChild(finalscoreElement);
}

// Funktion, um das Ergebnis nach dem Spiel zu kontrollieren
function checkGameEndAndPoints() {
    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");
    const player1Events = document.querySelectorAll(".player-container:nth-child(1) .entry");
    const player2Events = document.querySelectorAll(".player-container:nth-child(2) .entry");

    const player1HasGameEnd = Array.from(player1Events).some(event => event.textContent.includes("Endstand"));
    const player2HasGameEnd = Array.from(player2Events).some(event => event.textContent.includes("Endstand"));

    const player1Score = parseInt(player1ScoreElement.textContent);
    const player2Score = parseInt(player2ScoreElement.textContent);

    if (player1HasGameEnd && player2HasGameEnd && player1Score === player2Score) {
    const shootoutConfirmed = confirm("Unentschieden. Soll es ein Elfmeterschießen geben?");
    if (shootoutConfirmed) {
    startElfmeterschiessen();
    } else {
    alert("Das Spiel endet Unentschieden.");
    }
    }
}

const playersContainer = document.getElementById('playersContainer');
const player1Container = document.getElementById('player1Container');
const player2Container = document.getElementById('player2Container');

// Event-Handler, der auf das Scrollen eines Containers reagiert
    player1Container.addEventListener('scroll', function () {
    player2Container.scrollTop = player1Container.scrollTop;
    });

    player2Container.addEventListener('scroll', function () {
    player1Container.scrollTop = player2Container.scrollTop;
});


// Funktion, die einen Torsound abspielt
function playGoalSound() {
    const goalSound = new Audio('sounds/goal.mp3');
    goalSound.play();
}

// Funktion zum Abspielen des Halbzeit-Sounds
    function playHalftimeSound() {
        const halftimeSound = new Audio("sounds/halftime.mp3");
        halftimeSound.currentTime = 0.3; // Setze die Startposition auf 0,3 Sekunden
        halftimeSound.play();
    }

// Funktion zum Abspielen des Sieger-Sounds
function playWinSound() {
    const sound = new Audio("sounds/win.wav");
    sound.play();
}

// Funktion, um den Siegerbildschirm anzuzeigen
function showWinnerScreen(player1Name) {
    // Erstellen des Overlay-Divs
    const overlay = document.createElement("div");
    overlay.classList.add("winner-overlay");

    // Hinzufügen des Siegerinhalts
    const winnerContent = document.createElement("div");
    winnerContent.classList.add("winner-content");

    // Hinzufügen des Sieger-GIFs
    const winnerGif = document.createElement("img");
    winnerGif.src = "graphics/winner.gif";
    winnerGif.alt = "Winner GIF";
    winnerContent.appendChild(winnerGif);

    // Hinzufügen des Siegertexts
    const winnerText = document.createElement("p");
    winnerText.classList.add("bold-text"); // Fett gedruckter Text
    winnerText.textContent = "Gratulation, " + player1Name + "!";
    winnerContent.appendChild(winnerText);

    // Hinzufügen des zusätzlichen Texts
    const additionalText = document.createElement("p");
    additionalText.classList.add("additional-text");
    additionalText.innerHTML = 'Du hast bei <strong>WHAT A GOAL!</strong> gewonnen!';
    winnerContent.appendChild(additionalText);

    // Hinzufügen des "Neues Spiel"-Buttons
    const newGameButton = document.createElement("button");
    newGameButton.textContent = "Neues Spiel starten";
    newGameButton.addEventListener("click", startNewGame);
    winnerContent.appendChild(newGameButton);

    overlay.appendChild(winnerContent);

    // Hinzufügen des Overlay-Divs zum Dokument
    document.body.appendChild(overlay);
}

// Funktion, um den Siegerbildschirm anzuzeigen
function showWinnerScreen(winnerName) {
    const overlay = document.createElement("div");
    overlay.classList.add("winner-overlay");

    // Hinzufügen des Siegerinhalts
    const winnerContent = document.createElement("div");
    winnerContent.classList.add("winner-content");

    // Hinzufügen des Sieger-GIFs
    const winnerGif = document.createElement("img");
    winnerGif.src = "graphics/winner.gif";
    winnerGif.alt = "Winner GIF";
    winnerContent.appendChild(winnerGif);

    // Hinzufügen des Siegertexts
    const winnerText = document.createElement("p");
    winnerText.classList.add("bold-text"); // Fett gedruckter Text

    winnerContent.appendChild(winnerText);

    // Hinzufügen des zusätzlichen Texts
    const additionalText = document.createElement("p");
    additionalText.classList.add("additional-text");
    additionalText.innerHTML = 'Du hast bei <strong>WHAT A GOAL!</strong> gewonnen!';
    winnerContent.appendChild(additionalText);
    winnerText.textContent = "Gratulation, " + winnerName + "!";

    // Hinzufügen des "Neues Spiel"-Buttons
    const newGameButton = document.createElement("button");
    newGameButton.textContent = "Neues Spiel starten";
    newGameButton.addEventListener("click", startNewGame);
    winnerContent.appendChild(newGameButton);

    // Hinzufügen des "Spielverlauf ansehen"-Buttons
    const viewGameHistoryButton = document.createElement("button");
    viewGameHistoryButton.textContent = "Spielverlauf ansehen";
    
    // Hier wird der Abstand von 20px links hinzugefügt
    viewGameHistoryButton.style.marginLeft = "20px";
    
    viewGameHistoryButton.addEventListener("click", closeWinnerScreen);
    winnerContent.appendChild(viewGameHistoryButton);

    overlay.appendChild(winnerContent);

    // Hinzufügen des Overlay-Divs zum Dokument
    document.body.appendChild(overlay);
}

// Funktion, um den Gewinner zu ermitteln und den Siegerbildschirm anzuzeigen
function checkWinnerAndShowScreen() {
    const player1ScoreElement = document.getElementById("player1Score");
    const player2ScoreElement = document.getElementById("player2Score");

    const player1NameElement = document.querySelector(".player-container:nth-child(1) .player-name");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
    const player1Name = player1NameElement.textContent.trim();
    const player2Name = player2NameElement.textContent.trim();

    const player1Score = parseInt(player1ScoreElement.textContent);
    const player2Score = parseInt(player2ScoreElement.textContent);

    if (player1Score > player2Score) {
        showWinnerScreen(player1Name);
        playWinSound();
    } else if (player2Score > player1Score) {
        showWinnerScreen(player2Name);
        playWinSound();
    } else {
        checkGameEndAndPoints()
    }
}

// Funktion, um den Siegerbildschirm zu schließen
function closeWinnerScreen() {
    const overlay = document.querySelector(".winner-overlay");
    if (overlay) {
        overlay.remove();
    }
}

// Modal und Buttons auswählen
  const xgModal = document.getElementById('xgRechnerModal');
  const xgOpenModalBtn = document.getElementById('xgOpenModal');
  const xgCloseModalBtn = document.getElementById('xgCloseModal');
  const xgAddShotBtns = document.querySelectorAll('.xg-add-shot-btn');

  // Modal öffnen
  xgOpenModalBtn.addEventListener('click', () => {
    xgModal.style.display = 'flex';
  });

  // Modal schließen
  xgCloseModalBtn.addEventListener('click', () => {
    xgModal.style.display = 'none';
  });

  // Funktion zur Formatierung von Dezimalzahlen
  function xgFormatNumber(number) {
    return number.toString().replace('.', ',');
  }

  // Schüsse hinzufügen und entfernen
xgAddShotBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        const playerNum = btn.getAttribute('data-player');
        const wasPenalty = confirm('Ist der Schuss ein Elfmeter?');

        let xgValue = 0;
        if (wasPenalty) {
            xgValue = 0.67;
        } else {
            const shotStrength = parseFloat(prompt(`Schussstärke`).replace(',', '.')) || 0;
            const ownMarkerValue = parseFloat(prompt(`Aufstellungsmarkerwert auf dem Feld`).replace(',', '.')) || 0;
            const fieldsToGoal = parseFloat(prompt(`Felder bis zum Tor`).replace(',', '.')) || 0;
            const additionalBonuses = parseFloat(prompt(`Zusätzliche Boni`).replace(',', '.')) || 0;

            const intermediateResult = shotStrength + ownMarkerValue - fieldsToGoal + additionalBonuses;

            const opponentMarkerValue = parseFloat(prompt(`Gegn. Aufstellungsmarkerwert in Schusslinie`).replace(',', '.')) || 0;
            const opponentGoalieBonuses = parseFloat(prompt(`Gegn. Torwart-Boni`).replace(',', '.')) || 0;

            const requiredRoll = intermediateResult - opponentGoalieBonuses;
            const minRequiredRoll = Math.max(Math.round(requiredRoll), 0);
            alert(`Benötigter Mindestwürfelwurf des Torwarts: ${minRequiredRoll.toLocaleString('de-DE')}`);

            xgValue = xgCalculatexG(opponentMarkerValue, minRequiredRoll);
        }

        const xgList = document.getElementById(`xgPlayer${playerNum}Shots`);
        const li = document.createElement('li');
        li.textContent = `Schuss ${xgList.childElementCount + 1}: ${xgValue.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace('.', ',')} xG`;
        xgList.appendChild(li);

        const totalxg = document.getElementById(`xgPlayer${playerNum}Totalxg`);
        const newXgTotal = parseFloat(totalxg.textContent.replace(',', '.')) + xgValue;
        totalxg.textContent = newXgTotal === 0 ? '0,00' : newXgTotal.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace('.', ',');

    // Überprüfe, ob bereits ein "Schuss entfernen" Button vorhanden ist
    const existingRemoveBtn = document.querySelector('.xg-remove-shot-btn[data-player="' + playerNum + '"]');
        if (existingRemoveBtn) {
            existingRemoveBtn.parentNode.removeChild(existingRemoveBtn);
        }

        const removeShotBtn = document.createElement('button');
        removeShotBtn.textContent = '-';
        removeShotBtn.classList.add('xg-remove-shot-btn');
        removeShotBtn.setAttribute('data-player', playerNum);
        removeShotBtn.addEventListener('click', () => {
            const lastShot = xgList.lastElementChild;
            if (lastShot) {
                const xgValueToRemove = parseFloat(lastShot.textContent.match(/\d+\,\d+/)[0].replace(',', '.'));

                xgList.removeChild(lastShot);

                const updatedXgTotal = parseFloat(totalxg.textContent.replace(',', '.')) - xgValueToRemove;
                totalxg.textContent = updatedXgTotal === 0 ? '0,00' : updatedXgTotal.toLocaleString('de-DE', { minimumFractionDigits: 2, maximumFractionDigits: 2 }).replace('.', ',');
            }
        });
        btn.parentNode.insertBefore(removeShotBtn, btn.nextSibling);
    });
});

// Funktion zur Berechnung der Torwahrscheinlichkeit
function xgCalculatexG(opponentMarkerValue, requiredRoll) {
    const valueA = opponentMarkerValue;
    const valueB = requiredRoll;
    const xg = ((1 - (1 - (5 / 6) ** valueA))) * (valueB >= 7 ? 1 : (1 - (7 - valueB) / 6 > 1 ? 1 : ((1 - (1 - (5 / 6) ** valueA)) * (1 - (7 - valueB) / 6 < 0 ? 0 : 1 - (7 - valueB) / 6))));
    return xg;
  }

// Funktion zum Öffnen des xG-Rechners
function openXGRechner() {
  const xgModal = document.getElementById("xgRechnerModal");
  const player1XGModalNameElement = document.getElementById("player1XGModalName");
  player1XGModalNameElement.textContent = player1Name;

  const player2XGModalNameElement = document.getElementById("player2XGModalName");
  const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");
  player2XGModalNameElement.textContent = player2NameElement.textContent;
  player2XGModalNameElement.style.color = getComputedStyle(player2NameElement).color;

  xgModal.style.display = 'flex';
}

function closeXGRechner() {
    xgModal.style.display = 'none';
}

// Funktion, um die xG-Werte im Body anzuzeigen
function displayXGValuesInBody() {
    // Funktion, die die aktuellen xG-Werte aus dem Modal abruft und im Body anzeigt
    function updateXGValues() {
        // Die aktuellen xG-Werte der Spieler aus dem Modal lesen
        var player1XG = document.getElementById('xgPlayer1Totalxg').innerText;
        var player2XG = document.getElementById('xgPlayer2Totalxg').innerText;

        // Die Elemente im Body finden, um die xG-Werte anzuzeigen
        var player1XGDisplay = document.getElementById('player1XGValue');
        var player2XGDisplay = document.getElementById('player2XGValue');

        // Die xG-Werte in den Body einfügen
        player1XGDisplay.innerText = player1XG;
        player2XGDisplay.innerText = player2XG;
    }

    // Die Funktion updateXGValues alle 1000 Millisekunden (1 Sekunde) aufrufen
    setInterval(updateXGValues, 1000);
}

// Diese Funktion aufrufen, um die xG-Werte im Body anzuzeigen
displayXGValuesInBody();

// Funktion, um das Statistiken-Modal zu öffnen
function openStats() {
    // Namen der Spieler von der Hauptseite holen
    const player1NameElement = document.querySelector(".player-container:nth-child(1) .player-name");
    const player2NameElement = document.querySelector(".player-container:nth-child(2) .player-name");

    // Namen in die Modal-Tabelle einfügen
    document.getElementById('player1StatsName').textContent = player1NameElement.textContent;
    document.getElementById('player2StatsName').textContent = player2NameElement.textContent;
    
    // Stil von Spieler 2 übernehmen
    document.getElementById('player2StatsName').style.color = getComputedStyle(player2NameElement).color;
    
    // Statistiken in die Modal-Tabelle einfügen
    document.getElementById('passesPlayer1').textContent = passesPlayer1 + missedpassesPlayer1;
    document.getElementById('passesPlayer2').textContent = passesPlayer2 + missedpassesPlayer2;
    document.getElementById('dribblingsPlayer1').textContent = dribblingsPlayer1 + faileddribblingsPlayer1;
    document.getElementById('dribblingsPlayer2').textContent = dribblingsPlayer2 + faileddribblingsPlayer2;
    document.getElementById('tacklesPlayer1').textContent = tacklesPlayer1 + failedtacklesPlayer1;
    document.getElementById('tacklesPlayer2').textContent = tacklesPlayer2 + failedtacklesPlayer2;
    document.getElementById('starPlayer1').textContent = starPlayer1;
    document.getElementById('starPlayer2').textContent = starPlayer2;
    
    // Erfolgreiche Pässe und deren Prozentwert berechnen
    const successfulPassesPlayer1 = passesPlayer1;
    const totalPassesPlayer1 = passesPlayer1 + missedpassesPlayer1;
    const successfulPassesPlayer2 = passesPlayer2;
    const totalPassesPlayer2 = passesPlayer2 + missedpassesPlayer2;
    
    const successfulPassesPlayer1Percent = totalPassesPlayer1 > 0 ? Math.round((successfulPassesPlayer1 / totalPassesPlayer1) * 100) : 0;
    const successfulPassesPlayer2Percent = totalPassesPlayer2 > 0 ? Math.round((successfulPassesPlayer2 / totalPassesPlayer2) * 100) : 0;

    // Erfolgreiche Pässe und deren Prozentwert in der Tabelle einfügen
    document.getElementById('successfulPassesPlayer1').textContent = successfulPassesPlayer1 + " (" + successfulPassesPlayer1Percent + "%)";
    document.getElementById('successfulPassesPlayer2').textContent = successfulPassesPlayer2 + " (" + successfulPassesPlayer2Percent + "%)";

    // Erfolgreiche Dribblings und deren Prozentwert berechnen
    const successfulDribblingsPlayer1 = dribblingsPlayer1;
    const totalDribblingsPlayer1 = dribblingsPlayer1 + faileddribblingsPlayer1;
    const successfulDribblingsPlayer2 = dribblingsPlayer2;
    const totalDribblingsPlayer2 = dribblingsPlayer2 + faileddribblingsPlayer2;
    
    const successfulDribblingsPlayer1Percent = totalDribblingsPlayer1 > 0 ? Math.round((successfulDribblingsPlayer1 / totalDribblingsPlayer1) * 100) : 0;
    const successfulDribblingsPlayer2Percent = totalDribblingsPlayer2 > 0 ? Math.round((successfulDribblingsPlayer2 / totalDribblingsPlayer2) * 100) : 0;

    // Erfolgreiche Dribblings und deren Prozentwert in der Tabelle einfügen
    document.getElementById('successfulDribblingsPlayer1').textContent = successfulDribblingsPlayer1 + " (" + successfulDribblingsPlayer1Percent + "%)";
    document.getElementById('successfulDribblingsPlayer2').textContent = successfulDribblingsPlayer2 + " (" + successfulDribblingsPlayer2Percent + "%)";

    // Erfolgreiche Zweikämpfe und deren Prozentwert berechnen
    const successfultacklesPlayer1 = tacklesPlayer1;
    const totaltacklesPlayer1 = tacklesPlayer1 + failedtacklesPlayer1;
    const successfultacklesPlayer2 = tacklesPlayer2;
    const totaltacklesPlayer2 = tacklesPlayer2 + failedtacklesPlayer2;
    
    const successfultacklesPlayer1Percent = totaltacklesPlayer1 > 0 ? Math.round((successfultacklesPlayer1 / totaltacklesPlayer1) * 100) : 0;
    const successfultacklesPlayer2Percent = totaltacklesPlayer2 > 0 ? Math.round((successfultacklesPlayer2 / totaltacklesPlayer2) * 100) : 0;

    // Erfolgreiche Zweikämpfe und deren Prozentwert in der Tabelle einfügen
    document.getElementById('successfultacklesPlayer1').textContent = successfultacklesPlayer1 + " (" + successfultacklesPlayer1Percent + "%)";
    document.getElementById('successfultacklesPlayer2').textContent = successfultacklesPlayer2 + " (" + successfultacklesPlayer2Percent + "%)";
    
    // Berechnung des Gesamtballbesitzes und der Prozentwerte
    const totalBallPossession = ballPossessionPlayer1 + ballPossessionPlayer2;
    const ballPossessionPlayer1Percent = totalBallPossession > 0 ? Math.round((ballPossessionPlayer1 / totalBallPossession) * 100) : 0;  // Prozentwert für Spieler 1 berechnen und runden
    const ballPossessionPlayer2Percent = totalBallPossession > 0 ? Math.round((ballPossessionPlayer2 / totalBallPossession) * 100) : 0;  // Prozentwert für Spieler 2 berechnen und runden

    // Ballbesitz in der Tabelle einfügen
    document.getElementById('ballPossessionPlayer1').textContent = ballPossessionPlayer1 + " (" + ballPossessionPlayer1Percent + "%)";
    document.getElementById('ballPossessionPlayer2').textContent = ballPossessionPlayer2 + " (" + ballPossessionPlayer2Percent + "%)";

    // Starspieler ausgespielt in der Tabelle einfügen
    document.getElementById('starPlayer1').textContent = starPlayer1;
    document.getElementById('starPlayer2').textContent = starPlayer2;

    // Fouls anzeigen
    document.getElementById('foulsPlayer1').textContent = foulsPlayer1;
    document.getElementById('foulsPlayer2').textContent = foulsPlayer2;

    // Gelbe Karten anzeigen
    document.getElementById('yellowCardPlayer1').textContent = yellowCardCountPlayer1;
    document.getElementById('yellowCardPlayer2').textContent = yellowCardCountPlayer2;

    // Rote Karten anzeigen
    document.getElementById('redCardsPlayer1').textContent = redCardsPlayer1;
    document.getElementById('redCardsPlayer2').textContent = redCardsPlayer2;

    // Gesamtzahl der Elfmeter im Modal anzeigen
    document.getElementById('penaltiesPlayer1').textContent = penaltiesPlayer1;
    document.getElementById('penaltiesPlayer2').textContent = penaltiesPlayer2;

    // Berechnung der Gesamtzahl der Spielzüge
    const totalTurns = ballPossessionPlayer1 + ballPossessionPlayer2;

    // Gesamtzahl der Spielzüge im Modal anzeigen
    document.getElementById('totalTurns').textContent = "In diesem Spiel wurden insgesamt " + totalTurns + " Spielzüge ausgeführt.";

    // Spieler 1 Score und xG in die Modal-Tabelle einfügen
    const player1Score = document.getElementById('player1Score').textContent;
    const player1XGValue = document.getElementById('player1XGValue').textContent;

    document.getElementById('player1ScoreModal').textContent = player1Score;
    document.getElementById('player1XGModal').textContent = player1XGValue;

    // Spieler 2 Score und xG in die Modal-Tabelle einfügen
    const player2Score = document.getElementById('player2Score').textContent;
    const player2XGValue = document.getElementById('player2XGValue').textContent;

    document.getElementById('player2ScoreModal').textContent = player2Score;
    document.getElementById('player2XGModal').textContent = player2XGValue;

    // Zählen der xG-Einträge und im Modal anzeigen
    const xGEntriesPlayer1 = countXGEntries(1);
    const xGEntriesPlayer2 = countXGEntries(2);

    document.getElementById('lastShotPlayer1').textContent = xGEntriesPlayer1;
    document.getElementById('lastShotPlayer2').textContent = xGEntriesPlayer2;

    // Modal anzeigen
    document.getElementById('statsModal').style.display = 'block';
}

// Funktion, um das Statistiken-Modal zu schließen
function closeStats() {
    document.getElementById('statsModal').style.display = 'none';
}

// Ballbesitz-Werte initialisieren
    let ballPossessionPlayer1 = 0;
    let ballPossessionPlayer2 = 0;

    // Funktion zur Handhabung der Ballbesitz-Abfrage
    function confirmBallPossession(player) {
    const message = "Hat dieser Spieler am Ende des Spielzugs Ballbesitz?";

    if (confirm(message)) {
        // Spieler-Container abrufen
        const player1Container = document.getElementById("player1Container");
        const player2Container = document.getElementById("player2Container");

        // Aktuellen Pulse-Effekt prüfen
        const player1HasPulse = player1Container.classList.contains("pulse-red") || player1Container.classList.contains("pulse-blue");
        const player2HasPulse = player2Container.classList.contains("pulse-red") || player2Container.classList.contains("pulse-blue");

        // Effekt stoppen
        player1Container.classList.remove("pulse-red", "pulse-blue");
        player2Container.classList.remove("pulse-red", "pulse-blue");

        // Pulse-Effekt beim Spieler starten, der ihn vorher **nicht** hatte
        if (player1HasPulse) {
            player2Container.classList.add("pulse-blue");
        } else if (player2HasPulse) {
            player1Container.classList.add("pulse-red");
        }

        // Ballbesitz erhöhen
        if (player === 1) {
            ballPossessionPlayer1++;
            alert("Der Ballbesitz dieses Spielers wurde auf " + ballPossessionPlayer1 + " erhöht.");
        } else if (player === 2) {
            ballPossessionPlayer2++;
            alert("Der Ballbesitz dieses Spielers wurde auf " + ballPossessionPlayer2 + " erhöht.");
        }
    }
}

// Erfolgreiche und fehlgeschlagene Pässe initialisieren
let passesPlayer1 = 0;
let missedpassesPlayer1 = 0;
let passesPlayer2 = 0;
let missedpassesPlayer2 = 0;

// Funktion zur Handhabung der Erfolgreiche-Pässe-Abfrage
function passes(player) {
    const passExecutionMessage = "Hat dieser Spieler einen Pass ausgeführt?";
    const successMessage = "War der Pass erfolgreich?";
    
    // Erst fragen, ob der Pass ausgeführt wurde
    if (confirm(passExecutionMessage)) {
        // Wenn der Pass ausgeführt wurde, frage, ob er erfolgreich war
        if (confirm(successMessage)) {
            // Wenn der Pass erfolgreich war, den Wert für erfolgreiche Pässe erhöhen
            if (player === 1) {
                passesPlayer1++;
                alert("Die erfolgreichen Pässe dieses Spielers wurden auf " + passesPlayer1 + " erhöht.");
            } else if (player === 2) {
                passesPlayer2++;
                alert("Die erfolgreichen Pässe dieses Spielers wurden auf " + passesPlayer2 + " erhöht.");
            }
        } else {
            // Wenn der Pass nicht erfolgreich war, den Wert für fehlgeschlagene Pässe erhöhen
            if (player === 1) {
                missedpassesPlayer1++;
                alert("Die fehlgeschlagenen Pässe dieses Spielers wurden auf " + missedpassesPlayer1 + " erhöht.");
            } else if (player === 2) {
                missedpassesPlayer2++;
                alert("Die fehlgeschlagenen Pässe dieses Spielers wurden auf " + missedpassesPlayer2 + " erhöht.");
            }
        }
    }
}

// Erfolgreiche und fehlgeschlagene Dribblings initialisieren
let dribblingsPlayer1 = 0;
let faileddribblingsPlayer1 = 0;
let dribblingsPlayer2 = 0;
let faileddribblingsPlayer2 = 0;

// Funktion zur Handhabung der Erfolgreiche-Dribblings-Abfrage
function dribblings(player) {
    const dribblingExecutionMessage = "Hat dieser Spieler ein Dribbling ausgeführt?";
    const successMessage = "War das Dribbling erfolgreich?";
    
    // Erst fragen, ob das Dribbling ausgeführt wurde
    if (confirm(dribblingExecutionMessage)) {
        // Wenn das Dribbling ausgeführt wurde, frage, ob es erfolgreich war
        if (confirm(successMessage)) {
            // Wenn das Dribbling erfolgreich war, den Wert für erfolgreiche Dribblings erhöhen
            if (player === 1) {
                dribblingsPlayer1++;
                alert("Die erfolgreichen Dribblings dieses Spielers wurden auf " + dribblingsPlayer1 + " erhöht.");
            } else if (player === 2) {
                dribblingsPlayer2++;
                alert("Die erfolgreichen Dribblings dieses Spielers wurden auf " + dribblingsPlayer2 + " erhöht.");
            }
        } else {
            // Wenn das Dribbling nicht erfolgreich war, den Wert für fehlgeschlagene Dribblings erhöhen
            if (player === 1) {
                faileddribblingsPlayer1++;
                alert("Die fehlgeschlagenen Dribblings dieses Spielers wurden auf " + faileddribblingsPlayer1 + " erhöht.");
            } else if (player === 2) {
               faileddribblingsPlayer2++;
                alert("Die fehlgeschlagenen Dribblings dieses Spielers wurden auf " + faileddribblingsPlayer2 + " erhöht.");
            }
        }
    }
}

// Erfolgreiche und fehlgeschlagene Zweikämpfe initialisieren
let tacklesPlayer1 = 0;
let failedtacklesPlayer1 = 0;
let tacklesPlayer2 = 0;
let failedtacklesPlayer2 = 0;

// Funktion zur Handhabung der Erfolgreiche-Zweikampf-Abfrage
function tackles(player) {
    const tacklesExecutionMessage = "Hat dieser Spieler einen Zweikampf ausgeführt?";
    const successMessage = "War der Zweikampf erfolgreich?";
    
    // Erst fragen, ob der Zweikampf ausgeführt wurde
    if (confirm(tacklesExecutionMessage)) {
        // Wenn der Zweikampf ausgeführt wurde, frage, ob er erfolgreich war
        if (confirm(successMessage)) {
            // Wenn der Zweikampf erfolgreich war, den Wert für erfolgreiche Zweikämpfe erhöhen
            if (player === 1) {
                tacklesPlayer1++;
                alert("Die erfolgreichen Zweikämpfe dieses Spielers wurden auf " + tacklesPlayer1 + " erhöht.");
            } else if (player === 2) {
                tacklesPlayer2++;
                alert("Die erfolgreichen Zweikämpfe dieses Spielers wurden auf " + tacklesPlayer2 + " erhöht.");
            }
        } else {
            // Wenn der Zweikampf nicht erfolgreich war, den Wert für fehlgeschlagene Zweikämpfe erhöhen
            if (player === 1) {
                failedtacklesPlayer1++;
                alert("Die fehlgeschlagenen Zweikämpfe dieses Spielers wurden auf " + failedtacklesPlayer1 + " erhöht.");
            } else if (player === 2) {
               failedtacklesPlayer2++;
                alert("Die fehlgeschlagenen Zweikämpfe dieses Spielers wurden auf " + failedtacklesPlayer2 + " erhöht.");
            }
        }
    }
}

// Initialisierung der neuen Variablen für Starspieler ausgespielt
let starPlayer1 = 0;
let starPlayer2 = 0;

// Funktion zur Handhabung der Starspieler ausgespielt-Abfrage
function starPlayer(player) {
    const message = "Hat dieser Spieler einen Starspieler ausgespielt?";
    
    // Bestätigung, ob der Spieler einen Starspieler ausgespielt hat
    if (confirm(message)) {
        // Wenn der Spieler "OK" klickt, den Wert für den Starspieler erhöhen
        if (player === 1) {
            starPlayer1++;
            alert("Die Anzahl der Starspieler, die dieser Spieler ausgespielt hat, wurde auf " + starPlayer1 + " erhöht.");
        } else if (player === 2) {
            starPlayer2++;
            alert("Die Anzahl der Starspieler, die dieser Spieler ausgespielt hat, wurde auf " + starPlayer2 + " erhöht.");
        }
    }
}

// Funktion zum Zählen der xG-Einträge für einen Spieler
function countXGEntries(playerId) {
    const shotList = document.querySelector(`#xgPlayer${playerId}Shots`);
    const shots = shotList.querySelectorAll('li');
    
    // Die Anzahl der xG-Einträge wird einfach durch die Anzahl der Listeneinträge ermittelt
    return shots.length;
}

// Funktion zum Aktualisieren der Anzahl der xG-Einträge im Statistiken Modal
function updateXGEntriesInStatsModal() {
    const xGEntriesPlayer1 = countXGEntries(1);
    const xGEntriesPlayer2 = countXGEntries(2);
    
    // Anzeige der xG-Einträge im Statistiken Modal
    document.getElementById('lastShotPlayer1').textContent = xGEntriesPlayer1;
    document.getElementById('lastShotPlayer2').textContent = xGEntriesPlayer2;
}

// Event-Listener für das Hinzufügen und Entfernen von Schüssen (bzw. xG-Einträgen)
document.querySelectorAll('.xg-add-shot-btn').forEach(button => {
    button.addEventListener('click', updateXGEntriesInStatsModal);
});

document.querySelectorAll('.xg-remove-shot-btn').forEach(button => {
    button.addEventListener('click', updateXGEntriesInStatsModal);
});

  // Hilfsfunktion zum Stylen der Buttons
function styleButton(btn) {
    btn.style.marginTop = "20px";
    btn.style.backgroundColor = "black";
    btn.style.color = "white";
    btn.style.border = "none";
    btn.style.padding = "10px 20px";
    btn.style.fontSize = "16px";
    btn.style.cursor = "pointer";
    btn.style.borderRadius = "5px";
    btn.style.fontFamily = "DINCond Medium";
}

// ---------- Modal 1 (Spielaufbau) ----------
function openSpielvorbereitungModal() {
    const modalOverlay = document.createElement("div");
    modalOverlay.classList.add("ht-modal-overlay");

    const modalBox = document.createElement("div");
    modalBox.classList.add("ht-modal-box");

    const modalTitle = document.createElement("h2");
    modalTitle.textContent = "Spielaufbau:";

    const modalText = document.createElement("p");
    modalText.innerHTML = `
        1. Spielbrett auf den Tisch legen. Jeder Spieler setzt sich an eine farbige Seite des Spielbretts.<br>
        2. Start-Mannschaftsstapel und Elfmeterkarten für jeden Spieler bereitlegen.<br>
        3. Beide Spieler legen 10 Aufstellungsmarker vor sich bereit.<br>
        4. Spielball auf den Anstoßkreis legen.<br>
        5. Würfel, die Spielzeitmarker beider Spieler, die 2 Gelben Karten und die 2 Roten Karten bereitlegen.<br>
        6. Aufstellungs- und Halbzeitansprachenstapel mischen und verdeckt bereitlegen.<br>
        7. Starspielerstapel mischen und verdeckt auf das Spielbrett legen.<br>
        8. Reservestapel mischen und verdeckt auf das Spielbrett legen.<br>
        9. Die obersten 6 Karten des Reservestapels neben dem Spielbrett aufdecken und den „Transfermarkt“ bilden.
    `;

    const closeButton = document.createElement("button");
    closeButton.textContent = "Erledigt";
    styleButton(closeButton);

    closeButton.addEventListener("click", () => {
        document.body.removeChild(modalOverlay);
        openSpielvorbereitung2Modal();
    });

    modalBox.appendChild(modalTitle);
    modalBox.appendChild(modalText);
    modalBox.appendChild(closeButton);
    modalOverlay.appendChild(modalBox);
    document.body.appendChild(modalOverlay);
}

// ---------- Modal 2 (Spielstart) ----------
function openSpielvorbereitung2Modal() {
    const modalOverlay2 = document.createElement("div");
    modalOverlay2.classList.add("ht-modal-overlay");

    const modalBox2 = document.createElement("div");
    modalBox2.classList.add("ht-modal-box");

    const modalTitle2 = document.createElement("h2");
    modalTitle2.textContent = "Spielstart:";

    const modalText2 = document.createElement("p");
    modalText2.innerHTML = `
        1. Beide Spieler würfeln. Der Spieler mit der höheren Augenzahl beginnt und ist aktiv.<br>
        2. Aktiver Spieler: 3 Karten vom Aufstellungsstapel ziehen, 1 auswählen, Rest zurückmischen.<br>
        3. Inaktiver Spieler: 3 Karten vom Aufstellungsstapel ziehen, 1 auswählen, Rest zurückmischen.<br>
        4. Aktiver Spieler: 3 Karten vom Halbzeitansprachenstapel ziehen, 2 auswählen, Rest zurückmischen.<br>
        5. Inaktiver Spieler: 3 Karten vom Halbzeitansprachenstapel ziehen, 2 auswählen, Rest zurückmischen.<br>
        6. Spielball auf die Farbe des aktiven Spielers drehen.<br>
        7. Spielzeitmarker des aktiven Spielers auf das Pfeifensymbol legen.<br>
        8. Beide Spieler mischen ihren Mannschaftsstapel und ziehen dann 6 Karten.<br>
        9. Inaktiver Spieler: Entscheiden, ob er alle 6 Handkarten ablegt und die übrigen 5 Karten auf die Hand nimmt.<br>
       10. Der aktive Spieler beginnt mit seinem Spielzug ...
    `;

    const closeButton2 = document.createElement("button");
    closeButton2.textContent = "Erledigt";
    styleButton(closeButton2);

    closeButton2.addEventListener("click", () => {
        document.body.removeChild(modalOverlay2);
        openSpielerwahlModal();
    });

    modalBox2.appendChild(modalTitle2);
    modalBox2.appendChild(modalText2);
    modalBox2.appendChild(closeButton2);
    modalOverlay2.appendChild(modalBox2);
    document.body.appendChild(modalOverlay2);
}

// ---------- Modal 3 (Spielerwahl) ----------
function openSpielerwahlModal() {
    const modalOverlay3 = document.createElement("div");
    modalOverlay3.classList.add("ht-modal-overlay");

    const modalBox3 = document.createElement("div");
    modalBox3.classList.add("ht-modal-box");

    const modalTitle3 = document.createElement("h2");
    modalTitle3.textContent = "Welcher Spieler beginnt?";

    // Container für Buttons
    const buttonContainer = document.createElement("div");
    buttonContainer.style.display = "flex";
    buttonContainer.style.justifyContent = "center";
    buttonContainer.style.gap = "15px";
    buttonContainer.style.marginTop = "20px";

    // Rot-Button
    const btnRed = document.createElement("button");
    btnRed.textContent = "Rot";
    styleButton(btnRed);
    btnRed.style.backgroundColor = "#ba3f1e"; // deine Rotfarbe
    btnRed.style.color = "white";

    // Blau-Button
    const btnBlue = document.createElement("button");
    btnBlue.textContent = "Blau";
    styleButton(btnBlue);
    btnBlue.style.backgroundColor = "#0e477c"; // deine Blaufarbe
    btnBlue.style.color = "white";

    // Events
    btnRed.addEventListener("click", () => {
        document.body.removeChild(modalOverlay3);

        const player1 = document.getElementById("player1Container");
        if (player1) {
            player1.classList.add("pulse-red");
        }
    });

    btnBlue.addEventListener("click", () => {
        document.body.removeChild(modalOverlay3);

        const player2 = document.getElementById("player2Container");
        if (player2) {
            player2.classList.add("pulse-blue");
        }
    });

    buttonContainer.appendChild(btnRed);
    buttonContainer.appendChild(btnBlue);

    modalBox3.appendChild(modalTitle3);
    modalBox3.appendChild(buttonContainer);
    modalOverlay3.appendChild(modalBox3);

    document.body.appendChild(modalOverlay3);
}

// Modal 1 direkt beim Laden öffnen
window.addEventListener("load", () => {
    openSpielvorbereitungModal();
});

function exportStatsAsImage() {
    const statsModalContent = document.querySelector('.stats-modal-content');
    const exportButton = document.getElementById('exportButton');
    const closeButton = document.querySelector('.stats-modal-content .close');

    // Button und X-Symbol vorübergehend ausblenden
    exportButton.style.display = 'none';
    closeButton.style.display = 'none';

    // html2canvas Screenshot
    html2canvas(statsModalContent).then(canvas => {
        const image = canvas.toDataURL("image/png");

        // Aktuelles Datum und Uhrzeit für Dateiname
        const now = new Date();
        const year = now.getFullYear();
        const month = String(now.getMonth() + 1).padStart(2, '0');
        const day = String(now.getDate()).padStart(2, '0');
        const hours = String(now.getHours()).padStart(2, '0');
        const minutes = String(now.getMinutes()).padStart(2, '0');
        const seconds = String(now.getSeconds()).padStart(2, '0');
        const filename = `Statistiken_${year}-${month}-${day}_${hours}-${minutes}-${seconds}.png`;

        // Download auslösen
        const link = document.createElement('a');
        link.href = image;
        link.download = filename;
        link.click();

        // Button und X-Symbol wieder einblenden
        exportButton.style.display = 'block';
        closeButton.style.display = 'inline';
    });
}
</script>
</body>
</html>
